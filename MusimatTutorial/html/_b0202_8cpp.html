<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Musimat Tutorial: /Users/garethloy/Musimathics/Musimat1.2/MusimatTutorial/B0202.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>/Users/garethloy/Musimathics/Musimat1.2/MusimatTutorial/B0202.cpp File Reference</h1>  </div>
</div>
<div class="contents">
<code>#include &quot;<a class="el" href="_musimat_tutorial_8h_source.html">MusimatTutorial.h</a>&quot;</code><br/>

<p><a href="_b0202_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b0202_8cpp.html#a01676fb7807dbed5de494f0ac5f25ea2">MusimatTutorialSection</a> (B0202)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b0202_8cpp.html#a313d0664eea167aba808f74d60faf912">realToRational</a> (Real f, Integer Reference num, Integer Reference den)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Static Void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b0202_8cpp.html#a6376be4538cba23c4fe0b4c245417d94">para1</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b0202_8cpp.html#a74c48c1a207b493e03a026b818e8bf79">realRhythm</a> (Rhythm <a class="el" href="_b0122_8cpp.html#a3132847d6ab4e9b9c9fa326b11cfe5f8">x</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_b0202_8cpp.html#a1d452a2b083a8baeeef2a26a73e64f2c">para2</a> ()</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a01676fb7807dbed5de494f0ac5f25ea2"></a><!-- doxytag: member="B0202.cpp::MusimatTutorialSection" ref="a01676fb7807dbed5de494f0ac5f25ea2" args="(B0202)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MusimatTutorialSection </td>
          <td>(</td>
          <td class="paramtype">B0202&#160;</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_b0202_8cpp_source.html#l00002">2</a> of file <a class="el" href="_b0202_8cpp_source.html">B0202.cpp</a>.</p>

<p>References <a class="el" href="_b0122_8cpp_source.html#l00025">para1()</a>, and <a class="el" href="_b0122_8cpp_source.html#l00073">para2()</a>.</p>
<div class="fragment"><pre class="fragment">                              {
        Print(<span class="stringliteral">&quot;*** B.2.2 Rhythm ***&quot;</span>);
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         </span>
<span class="comment">         B.2.2 Rhythm</span>
<span class="comment">         </span>
<span class="comment">         Duration in common music notation is expressed as a fraction of a whole note. For example a whole </span>
<span class="comment">         note equals four quarter notes:</span>
<span class="comment">         </span>
<span class="comment">         w  = q + q + q + q</span>
<span class="comment">         </span>
<span class="comment">         /*****************************************************************************</span>
<span class="comment">         We could write this mathematically as follows:</span>
<span class="comment">         </span>
<span class="comment">         1   1 1 1 1</span>
<span class="comment">         - = -,-,-,-</span>
<span class="comment">         1   4 4 4 4</span>
<span class="comment">         </span>
<span class="comment">         which suggests using rational fractions to represent rhythmic durations. A rational fraction is a </span>
<span class="comment">         ratio of integers. Musimat comes with a built-in data type called Rhythm, which emulates com-</span>
<span class="comment">         mon musical notation conventions regarding rhythm. For example, the quarter note is defined as</span>
<span class="comment">         *****************************************************************************/</span>
        
        Rhythm Q = Rhythm( 1, 4 );
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         The first number is the numerator of the rational fraction, the second is the denominator. Note that </span>
<span class="comment">         we can&#39;t write Rhythm(1/4) because the integer quotient of 1/4 is 0 with a remainder of 1; integer </span>
<span class="comment">         division is performed if both the numerator and denominator are integers, which won&#39;t work here. </span>
<span class="comment">         Specifying the numerator and denominator separately avoids this problem and has some other </span>
<span class="comment">         numerical advantages as well. Executing Print(Q); prints (1, 4). Internally, Rhythm() </span>
<span class="comment">         keeps the integer numerator and denominator values separately.</span>
<span class="comment">         </span>
<span class="comment">         Rhythmic duration can also be given as a real expression. </span>
<span class="comment">         *****************************************************************************/</span>
        
        Print(Rhythm(0.5)); 
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         prints (1, 2). How does Rhythm() convert this real expression into a ratio of integers? It does so by </span>
<span class="comment">         calling the following function internally:</span>
<span class="comment">         *****************************************************************************/</span>
        
        <a class="code" href="_b0122_8cpp.html#a6376be4538cba23c4fe0b4c245417d94">para1</a>();  <span class="comment">// Step into this function to continue the tutorial</span>
        <a class="code" href="_b0122_8cpp.html#a18e80f93d8c2934f3094f501ee77fc4b">para2</a>();  <span class="comment">// Step into this function to continue the tutorial</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a6376be4538cba23c4fe0b4c245417d94"></a><!-- doxytag: member="B0202.cpp::para1" ref="a6376be4538cba23c4fe0b4c245417d94" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Static Void para1 </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_b0202_8cpp_source.html#l00068">68</a> of file <a class="el" href="_b0202_8cpp_source.html">B0202.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                    {
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         Function realToRational() takes a Real value f and attempts to find a rational fraction </span>
<span class="comment">         num/den that is as close as possible to it. It starts by setting num = den = 1 and asking whether </span>
<span class="comment">         num/den is already close enough to f. If so, it returns. Otherwise, it asks whether (num+1) / den </span>
<span class="comment">         is closer than num / (den+1). If so, it increments num; otherwise it increments den and repeats the </span>
<span class="comment">         process. Because num and den are Reference arguments, any changes to these variables within </span>
<span class="comment">         realToRational() are reflected in the value of the actual arguments supplied to it.</span>
<span class="comment">         </span>
<span class="comment">         This method can be used to find rational approximations to most any real value. For example,</span>
<span class="comment">         *****************************************************************************/</span>
        
        Real Pi = 3.14159265;
        Print(Rhythm(Pi));
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         prints (1953857, 621932). Note that 1953857/621932 = 3.14159265, which is </span>
<span class="comment">         pretty close to the value of Pi. This method is limited by the precision of the computer hardware. </span>
<span class="comment">         The precision of a rational approximation depends upon the value of the built-in variables </span>
<span class="comment">         iterations and limit. For example, with the values shown in the preceding code, it took </span>
<span class="comment">         realToRational() 2,575,787 trials to come up with its best approximation of Pi, requiring </span>
<span class="comment">         about 1 second on my computer. The iteration and limit parameters can be set to whatever </span>
<span class="comment">         values produce the optimal performance/accuracy cost/benefit ratio. Barring obscure rhythms </span>
<span class="comment">         (nothing, say, beyond triplet eights), iterations = 240 and limit = 1.0/480 should be </span>
<span class="comment">         satisfactory.</span>
<span class="comment">         </span>
<span class="comment">         Although the details go beyond the scope of this book, here is a sketch of how Rhythm() uses </span>
<span class="comment">         realToRational():</span>
<span class="comment">         </span>
<span class="comment">         Rhythm(Real x) {</span>
<span class="comment">         Integer num, den; // internal parameters for Rhythm</span>
<span class="comment">         realToRational( x, num, den ); // convert x to num / den rational fraction</span>
<span class="comment">         // . . .</span>
<span class="comment">         }</span>
<span class="comment">         </span>
<span class="comment">         When called with a Real argument, Rhythm() calls realToRational() to set its internal integer </span>
<span class="comment">         rational fraction values.</span>
<span class="comment">         </span>
<span class="comment">         Musimat provides built-in definitions for standard binary divisions of a whole note:</span>
<span class="comment">         *****************************************************************************/</span>
        
        Rhythm Whole = Rhythm(1.0/1.0);
        Rhythm Half = Rhythm(1.0/2.0);
        Rhythm Quarter = Rhythm(1.0/4.0);
        Rhythm Eighth = Rhythm(1.0/8.0);
        Rhythm Sixteenth = Rhythm(1.0/16.0);
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         It is easy to define ternary divisions as well. For example, a triplet eighth is Rhythm(1.0/12.0) </span>
<span class="comment">         because there are  triplet eighths per whole note. By the same reasoning, a quintuplet </span>
<span class="comment">         eighth is </span>
<span class="comment">         *****************************************************************************/</span>
        
        Rhythm Qe = Rhythm(1.0/20.0);
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         We can express compound rhythms by addition. For example, a dotted half note is</span>
<span class="comment">         *****************************************************************************/</span>
        
        Rhythm Hd = Rhythm(1.0/2.0 + 1.0/4.0);                                  <span class="comment">// dotted half</span>
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         Equivalently,</span>
<span class="comment">         *****************************************************************************/</span>
        
        Rhythm H1 = Rhythm(3.0 / 4.0);                                                  <span class="comment">// also a dotted half</span>
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         We can also do arithmetic directly with rhythms. For example, </span>
<span class="comment">         *****************************************************************************/</span>
        
        Print(Eighth+Sixteenth); 
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         prints (3, 16). </span>
<span class="comment">         </span>
<span class="comment">         Also, </span>
<span class="comment">         *****************************************************************************/</span>
        
        Print(Whole - Sixteenth);
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         prints (15,16), </span>
<span class="comment">         *****************************************************************************/</span>
        
        Print(Quarter * Sixteenth);
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         prints (1,64), and </span>
<span class="comment">         *****************************************************************************/</span>
        
        Print(Quarter / Sixteenth);
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         prints (4,1). The last value corresponds to a duration of four whole notes.</span>
<span class="comment">         </span>
<span class="comment">         We can extract the numerator and denominator from Rhythm():</span>
<span class="comment">         *****************************************************************************/</span>
        
        Integer num, den;
        Rhythm z = Rhythm(Eighth + Sixteenth, num, den); <span class="comment">// assigns rational fraction for E+S to num and den</span>
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         Used this way, Rhythm() calculates the rational fraction of its first argument and sets num and </span>
<span class="comment">         den by reference to the result. For the preceding example, num is set to 3 and den is set to 16. We </span>
<span class="comment">         can leverage this capability to obtain the duration of a rhythm as a real number:</span>
<span class="comment">         *****************************************************************************/</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1d452a2b083a8baeeef2a26a73e64f2c"></a><!-- doxytag: member="B0202.cpp::para2" ref="a1d452a2b083a8baeeef2a26a73e64f2c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Void para2 </td>
          <td>(</td>
          <td class="paramname">&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_b0202_8cpp_source.html#l00184">184</a> of file <a class="el" href="_b0202_8cpp_source.html">B0202.cpp</a>.</p>
<div class="fragment"><pre class="fragment">             {

        <span class="comment">/*****************************************************************************</span>
<span class="comment">         Then, for example, executing Print(realRhythm(E + S)); prints 0.1875.</span>
<span class="comment">         As with pitches, we can make lists of rhythms.</span>
<span class="comment">         *****************************************************************************/</span>
        
        RhythmList RL = RhythmList(Quarter, Eighth, Eighth, Eighth, Sixteenth, Sixteenth, Quarter);
        Print(RL);
        
        <span class="comment">/*****************************************************************************</span>
<span class="comment">         prints {(1,4), (1,8), (1,8), (1,8), (1,16), (1,16), (1,4)}.</span>
<span class="comment">         *****************************************************************************/</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a74c48c1a207b493e03a026b818e8bf79"></a><!-- doxytag: member="B0202.cpp::realRhythm" ref="a74c48c1a207b493e03a026b818e8bf79" args="(Rhythm x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Real realRhythm </td>
          <td>(</td>
          <td class="paramtype">Rhythm&#160;</td>
          <td class="paramname"> <em>x</em>&#160;)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_b0202_8cpp_source.html#l00178">178</a> of file <a class="el" href="_b0202_8cpp_source.html">B0202.cpp</a>.</p>
<div class="fragment"><pre class="fragment">                          {
        Integer num, den;
        Rhythm(<a class="code" href="_b0122_8cpp.html#a3132847d6ab4e9b9c9fa326b11cfe5f8">x</a>, num, den); <span class="comment">// find rational fraction for x and set num and den</span>
        Return(Real(num)/Real(den)); <span class="comment">// convert num and den to reals and divide</span>
}
</pre></div>
</div>
</div>
<a class="anchor" id="a313d0664eea167aba808f74d60faf912"></a><!-- doxytag: member="B0202.cpp::realToRational" ref="a313d0664eea167aba808f74d60faf912" args="(Real f, Integer Reference num, Integer Reference den)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Void realToRational </td>
          <td>(</td>
          <td class="paramtype">Real&#160;</td>
          <td class="paramname"> <em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Integer Reference&#160;</td>
          <td class="paramname"> <em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Integer Reference&#160;</td>
          <td class="paramname"> <em>den</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="_b0202_8cpp_source.html#l00049">49</a> of file <a class="el" href="_b0202_8cpp_source.html">B0202.cpp</a>.</p>

<p>References <a class="el" href="_b0122_8cpp_source.html#l00018">x</a>, and <a class="el" href="_b0122_8cpp_source.html#l00019">y</a>.</p>
<div class="fragment"><pre class="fragment">                                                                          {
        Const Integer iterations = 3000000;
        Const Real limit = 0.000000000001;
        num = den = 1; <span class="comment">// start off with ratio of 1/1</span>
        For (Integer i = 0; i &lt; iterations; i = i + 1) {
                If (Abs( Real(num) / Real(den) - f ) &lt; limit)
                        Return; <span class="comment">// we have reached the limit</span>
                Else {
                        Real <a class="code" href="_b0122_8cpp.html#a3132847d6ab4e9b9c9fa326b11cfe5f8">x</a> = Abs(Real(num+1) / Real(den) - f);
                        Real <a class="code" href="_b0122_8cpp.html#a19c24134d2418eab72b507827c521754">y</a> = Abs(Real(num) / Real(den+1) - f);
                        If (x &lt; y)
                                num = num + 1;
                        Else
                                den = den + 1;
                }
        }
        Return; <span class="comment">// if we get here, we&#39;ve not converged on the limit</span>
}
</pre></div>
</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Fri Nov 26 2010 16:18:26 for Musimat Tutorial by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 </small></address>
</body>
</html>
